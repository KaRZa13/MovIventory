image: oven/bun:1

stages:
  - install
  - build

cache:
  paths:
    - node_modules/
    - bun.lockb

variables:
  EXPO_TOKEN: $EXPO_TOKEN
  CI: "true"

before_script:
  - bun install
  - bun add -g eas-cli expo-cli

install:
  stage: install
  script:
    - echo "âœ… DÃ©pendances installÃ©es avec Bun"

#build_android:
#  stage: build
#  script:
#    - echo "ğŸ” Authentification Expo..."
#    - bunx eas whoami || bunx eas login --token $EXPO_TOKEN
#    - echo "ğŸ—ï¸  Build APK en cours..."
#    - bunx eas build --platform android --profile preview --non-interactive
#  only:
#    - main

test_token:
  stage: build
  script:
    - echo "Length du token : ${#EXPO_TOKEN}"
    - bunx eas login --token $EXPO_TOKEN
  only:
    - main

